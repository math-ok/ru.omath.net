<div class="accentBlock" id="example:hats" data-type="example"><div class="side"><div class="type" title="Пример"><i></i></div><div class="expand" title="Решение"><div class="bgOverlay"></div><i class="ic-chevron-up"></i></div></div><div class="base"><div class="main"><section><div class="title">Задача Эйлера о шляпах</div><div class="content" data-content=""><p>Ресторан посетили <span class="mathInline strMode">4</span> человека. Свои шляпы они отдали швейцару.
На выходе невнимательный швейцар раздал шляпы случайным образом.
Сколько существует вариантов, когда каждый гость получил чужую шляпу?</p></div></section></div><div class="expand"><section><div class="title">Решение</div><div class="content" data-content=""><p>Дадим каждому человеку свой номер от <span class="mathInline strMode">1</span> до <span class="mathInline strMode">4</span>.
Каждой шляпе тоже дадим номер. Причем номер шляпы совпадает с номером ее владельца.
Шляпа <span class="mathInline strMode">3</span> принадлежит гостю <span class="mathInline strMode">3</span> и так далее.</p><p>Дальше придумаем, как удобно обозначать варианты выдачи шляп.
Будем записывать их в виде набора из четырех цифр, причем позиция цифры означает человека, а сама цифра номер шляпы.
Например, набор <span class="mathInline strMode">1234</span> означает, что каждый человек получил свою шляпу.
А набор <span class="mathInline strMode">1243</span> означает, что третий человек получил шляпу четвертого, а четвертый шляпу третьего:</p><div class="mathDisplay"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi><mover><mo><mn>1</mn></mo><mrow><mn>1</mn><mtext>ч</mtext></mrow></mover></mi><mtext> </mtext><mi><mover><mo><mn>2</mn></mo><mrow><mn>2</mn><mtext>ч</mtext></mrow></mover></mi><mtext> </mtext><mi><mover><mo><mn>4</mn></mo><mrow><mn>3</mn><mtext>ч</mtext></mrow></mover></mi><mtext> </mtext><mi><mover><mo><mn>3</mn></mo><mrow><mn>4</mn><mtext>ч</mtext></mrow></mover></mi></mrow><annotation encoding="application/x-tex">\overset{1\text{ч}}{1} \ \overset{2\text{ч}}{2} \ \overset{3\text{ч}}{4} \ \overset{4\text{ч}}{3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3955em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.3955em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">1</span></span></span><span style="top:-3.8444em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord text mtight"><span class="mord cyrillic_fallback mtight">ч</span></span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.3955em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">2</span></span></span><span style="top:-3.8444em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord text mtight"><span class="mord cyrillic_fallback mtight">ч</span></span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.3955em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">4</span></span></span><span style="top:-3.8444em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord text mtight"><span class="mord cyrillic_fallback mtight">ч</span></span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.3955em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">3</span></span></span><span style="top:-3.8444em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord text mtight"><span class="mord cyrillic_fallback mtight">ч</span></span></span></span></span></span></span></span></span></span></span></span></span></span></div><p>Мы свели задачу к тому, что нужно просто найти все наборы из четырех цифр, в которых <strong>позиция каждой цифры не равна самой цифре</strong>.</p><p>Введя подобные обозначения, мы выполнили первое <a class="link" href="/article/combinatorics/brute-force/#important:brute-force-rules" data-preview="@article|combinatorics/brute-force|important:brute-force-rules">правило</a> прямого перебора.
Но как не запутаться и перечислить все такие наборы цифр?
Для этого надо придумать грамотный алгоритм перебора (<span class="mathInline strMode">2</span>-е правило перебора).</p><p>Построим таблицу, в верхней строчке которой укажем номера гостей.
Потом добавляем строки с четырехзначными числами в <strong>порядке возрастания</strong>. Следим за тем, чтобы номер шляпы не совпал с номером человека.
Такие варианты вычеркиваем:</p><div class="mathDisplay"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.66em" columnalign="center center center center" columnspacing="1em" rowlines="solid none none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn><mtext>ч</mtext></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>2</mn><mtext>ч</mtext></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>3</mn><mtext>ч</mtext></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>4</mn><mtext>ч</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="red"><mn>2</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="red"><mn>1</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="red"><mn>3</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" style="border: 0.04em solid red" mathbackground="transparent"><mstyle mathcolor="red"><mtext>4</mtext></mstyle></mpadded></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="red"><mn>2</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="red"><mn>3</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="red"><mn>1</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" style="border: 0.04em solid red" mathbackground="transparent"><mstyle mathcolor="red"><mtext>4</mtext></mstyle></mpadded></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="red"><mn>2</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="red"><mn>4</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" style="border: 0.04em solid red" mathbackground="transparent"><mstyle mathcolor="red"><mtext>3</mtext></mstyle></mpadded></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="red"><mn>1</mn></mstyle></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">    \def\arraystretch{1.5}
    \begin{array}{cccc}
        1\text{ч} &amp; 2\text{ч} &amp; 3\text{ч} &amp; 4\text{ч} \\ \hline 
        \color{red} 2 &amp; \color{red} 1 &amp; \color{red} 3 &amp; \fcolorbox{red}{transparent}{\color{red}4} \\
        2 &amp; 1 &amp; 4 &amp; 3 \\
        \color{red} 2 &amp; \color{red} 3 &amp; \color{red} 1 &amp; \fcolorbox{red}{transparent}{\color{red}4} \\
        2 &amp; 3 &amp; 4 &amp; 1 \\
        2 &amp; 4 &amp; 1 &amp; 3 \\
        \color{red} 2 &amp; \color{red} 4 &amp; \fcolorbox{red}{transparent}{\color{red}3} &amp; \color{red} 1
    \end{array}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:12.6em;vertical-align:-6.05em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.55em;"><span style="top:-8.55em;"><span class="pstrut" style="height:8.55em;"></span><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.55em;"><span style="top:-8.55em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">1</span><span class="mord text"><span class="mord cyrillic_fallback">ч</span></span></span></span><span style="top:-6.75em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord" style="color:red;">2</span></span></span><span style="top:-4.95em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord" style="color:red;">2</span></span></span><span style="top:-1.35em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:0.45em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:2.25em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord" style="color:red;">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.05em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.55em;"><span style="top:-8.55em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">2</span><span class="mord text"><span class="mord cyrillic_fallback">ч</span></span></span></span><span style="top:-6.75em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord" style="color:red;">1</span></span></span><span style="top:-4.95em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord" style="color:red;">3</span></span></span><span style="top:-1.35em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:0.45em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:2.25em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord" style="color:red;">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.05em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.55em;"><span style="top:-8.55em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">3</span><span class="mord text"><span class="mord cyrillic_fallback">ч</span></span></span></span><span style="top:-6.75em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord" style="color:red;">3</span></span></span><span style="top:-4.95em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord" style="color:red;">1</span></span></span><span style="top:-1.35em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:0.45em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:2.25em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9844em;"><span style="top:-2.9844em;"><span class="pstrut" style="height:3.3244em;"></span><span class="stretchy fcolorbox" style="height:1.3244em;border-style:solid;border-width:0.04em;background-color:transparent;border-color:red;"></span></span><span style="top:-3.3244em;"><span class="pstrut" style="height:3.3244em;"></span><span class="mord boxpad"><span class="mord" style="color:red;">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.34em;"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.05em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.55em;"><span style="top:-8.55em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">4</span><span class="mord text"><span class="mord cyrillic_fallback">ч</span></span></span></span><span style="top:-6.75em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9844em;"><span style="top:-2.9844em;"><span class="pstrut" style="height:3.3244em;"></span><span class="stretchy fcolorbox" style="height:1.3244em;border-style:solid;border-width:0.04em;background-color:transparent;border-color:red;"></span></span><span style="top:-3.3244em;"><span class="pstrut" style="height:3.3244em;"></span><span class="mord boxpad"><span class="mord" style="color:red;">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.34em;"><span></span></span></span></span></span></span></span><span style="top:-4.95em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9844em;"><span style="top:-2.9844em;"><span class="pstrut" style="height:3.3244em;"></span><span class="stretchy fcolorbox" style="height:1.3244em;border-style:solid;border-width:0.04em;background-color:transparent;border-color:red;"></span></span><span style="top:-3.3244em;"><span class="pstrut" style="height:3.3244em;"></span><span class="mord boxpad"><span class="mord" style="color:red;">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.34em;"><span></span></span></span></span></span></span></span><span style="top:-1.35em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:0.45em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:2.25em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord" style="color:red;">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.05em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span style="top:-13.3em;"><span class="pstrut" style="height:8.55em;"></span><span class="hline" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.05em;"><span></span></span></span></span></span></span></span></span></span></div><p>Красным цветом помечены неподходящие варианты, то есть когда гость получил свою шляпу.
В красную рамочку взяты номера шляп, которые попали в руки своих владельцев.</p><p>Продолжая в том же духе, после вычеркивания всех лишних наборов, останется таблица во всеми нужными нам вариантами раздачи шляп:</p><div class="mathDisplay"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.66em" columnalign="center center center center" columnspacing="1em" rowlines="solid none none solid none none solid none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn><mtext>ч</mtext></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>2</mn><mtext>ч</mtext></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>3</mn><mtext>ч</mtext></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>4</mn><mtext>ч</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">    \def\arraystretch{1.5}
    \begin{array}{cccc}
        1\text{ч} &amp; 2\text{ч} &amp; 3\text{ч} &amp; 4\text{ч} \\ \hline 
        2 &amp; 1 &amp; 4 &amp; 3 \\
        2 &amp; 3 &amp; 4 &amp; 1 \\
        2 &amp; 4 &amp; 1 &amp; 3 \\ \hline
        3 &amp; 1 &amp; 4 &amp; 2 \\
        3 &amp; 4 &amp; 1 &amp; 2 \\
        3 &amp; 4 &amp; 2 &amp; 1 \\ \hline
        4 &amp; 1 &amp; 2 &amp; 3 \\
        4 &amp; 3 &amp; 1 &amp; 2 \\
        4 &amp; 3 &amp; 2 &amp; 1
    \end{array}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:18em;vertical-align:-8.75em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:9.25em;"><span style="top:-11.25em;"><span class="pstrut" style="height:11.25em;"></span><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:9.25em;"><span style="top:-11.25em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">1</span><span class="mord text"><span class="mord cyrillic_fallback">ч</span></span></span></span><span style="top:-9.45em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-7.65em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-5.85em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-4.05em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-0.45em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:1.35em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:3.15em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:4.95em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:8.75em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:9.25em;"><span style="top:-11.25em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">2</span><span class="mord text"><span class="mord cyrillic_fallback">ч</span></span></span></span><span style="top:-9.45em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-7.65em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-5.85em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-4.05em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-0.45em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:1.35em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:3.15em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:4.95em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:8.75em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:9.25em;"><span style="top:-11.25em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">3</span><span class="mord text"><span class="mord cyrillic_fallback">ч</span></span></span></span><span style="top:-9.45em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-7.65em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-5.85em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-4.05em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-0.45em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:1.35em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:3.15em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:4.95em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:8.75em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:9.25em;"><span style="top:-11.25em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">4</span><span class="mord text"><span class="mord cyrillic_fallback">ч</span></span></span></span><span style="top:-9.45em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-7.65em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-5.85em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-4.05em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-0.45em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:1.35em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:3.15em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:4.95em;"><span class="pstrut" style="height:3.26em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:8.75em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span style="top:-7.9em;"><span class="pstrut" style="height:11.25em;"></span><span class="hline" style="border-bottom-width:0.04em;"></span></span><span style="top:-13.3em;"><span class="pstrut" style="height:11.25em;"></span><span class="hline" style="border-bottom-width:0.04em;"></span></span><span style="top:-18.7em;"><span class="pstrut" style="height:11.25em;"></span><span class="hline" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:8.75em;"><span></span></span></span></span></span></span></span></span></span></div><p>Получаем всего <span class="mathInline strMode">9</span> вариантов, когда каждый гость получил чужую шляпу.</p></div></section></div></div></div>